<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coupon Roulette</title>
    <style>
        #roulette {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            border: 5px solid #333;
            position: relative;
            overflow: hidden;
            transform: rotate(0deg);
            transition: transform 2s ease-out;
        }
        .sector {
            position: absolute;
            width: 50%;
            height: 50%;
            background-color: lightblue;
            transform-origin: 100% 100%;
        }
        .sector:nth-child(1) {
            transform: rotate(0deg);
            background-color: #FF5733;
        }
        .sector:nth-child(2) {
            transform: rotate(90deg);
            background-color: #33FF57;
        }
        .sector:nth-child(3) {
            transform: rotate(180deg);
            background-color: #3357FF;
        }
        .sector:nth-child(4) {
            transform: rotate(270deg);
            background-color: #F0E68C;
        }
        .pointer {
            position: absolute;
            top: 0; /* 針を上部に配置 */
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 20px solid rgb(0, 0, 0) 針の色 */
            z-index: 10; /* 針を前面に表示 */
        }
        #spinButton {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Coupon Roulette</h1>
    <div id="roulette">
        <div class="sector"></div>
        <div class="sector"></div>
        <div class="sector"></div>
        <div class="sector"></div>
        <div class="pointer"></div>
    </div>
    <button id="spinButton">Spin the Roulette!</button>
    <button id="viewCouponButton" style="display:none;">獲得したクーポンを見る</button>

    <script>
        const sectors = ['クーポン1', 'クーポン2', 'クーポン3', 'クーポン4'];
        
        document.getElementById("spinButton").addEventListener("click", function() {
            this.style.display = 'none';

            // ランダムな回転角度を計算
            const spins = 5; // 5回転
            const randomAngle = Math.floor(Math.random() * 360);
            const totalRotation = 360 * spins + randomAngle;
            document.getElementById("roulette").style.transform = `rotate(${totalRotation}deg)`;

            setTimeout(() => {
                // 針が指しているセクターを計算
                const sectorIndex = Math.floor(((totalRotation % 360) / 360) * sectors.length) % sectors.length;
                const selectedCoupon = sectors[sectorIndex];

                alert("あなたが獲得したクーポン: " + selectedCoupon);
                document.getElementById("viewCouponButton").style.display = 'block'; 
            }, 2000);
        });

        document.getElementById("viewCouponButton").addEventListener("click", function() {
            window.location.href = "/coupondetail"; 
        });
    </script>
</body>
</html>
